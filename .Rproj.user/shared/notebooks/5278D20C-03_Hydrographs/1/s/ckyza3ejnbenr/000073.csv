"0",""
"0",""
"0","hydrograph2 <-"
"0","  function (input = matrix(ncol = 2, nrow = 2),"
"0","            streamflow = input[,"
"0","                               2],"
"0","            timeSeries = input[, 1],"
"0","            streamflow2 = NULL,"
"0","            precip = NULL,"
"0","            begin = 1,"
"0","            endindex = length(streamflow),"
"0","            P.units = """","
"0","            S.units = """","
"0","            S1.col = ""black"","
"0","            S2.col = ""red"","
"0","            stream.label = ""Water Depth (m)"","
"0","            streamflow3 = NULL,"
"0","            streamflow4 = NULL,"
"0","            streamflow5 = NULL,"
"0","            streamflow6 = NULL,"
"0","            streamflow7 = NULL,"
"0","            streamflow8 = NULL,"
"0","            streamflow9 = NULL,"
"0","            streamflow10 = NULL,"
"0","            precip2 = NULL) {"
"0","  "
"0","# PRECIP      "
"0","    if (is.null(streamflow2) & (ncol(input) > 3))"
"0","      streamflow2 <- input[, 4]"
"0","    if (is.null(precip) & (ncol(input) > 2)) {"
"0","      precip <- input[, 2]"
"0","      streamflow <- input[, 3]"
"0","    }"
"0","    if (!is.null(precip))  {"
"0","      par(mar = c(3, 5, 1, 4))"
"0","      barplot("
"0","        precip[begin:endindex],"
"0","        yaxt = ""n"","
"0","        space = NULL,"
"0","        ylim = rev(c(0, 4 * max(na.omit("
"0","          precip[begin:endindex]"
"0","        )))),"
"0","        xaxt = ""n"""
"0","      )"
"0",""
"0","      axis("
"0","        side = 3,"
"0","        pos = 0,"
"0","        tck = 0,"
"0","        xaxt = ""n"""
"0","      )"
"0","      r <-"
"0","        max(ceiling(-log10(max(na.omit("
"0","          precip[begin:endindex]"
"0","        )))), 0)"
"0","      axis("
"0","        side = 4,"
"0","        at = seq(0, round(max(na.omit("
"0","          precip[begin:endindex]"
"0","        )) +"
"0","          10 ^ (-r), r), length = (1 + ifelse("
"0","            round(max(na.omit(precip[begin:endindex])) +"
"0","                    10 ^"
"0","                    (-r), r) < 10 * 10 ^ (-r), floor(max(na.omit(precip[begin:endindex])) *"
"0","                                                       10 ^ r +"
"0","                                                       1), 4"
"0","          ))),"
"0","        labels = seq("
"0","          0,"
"0","          round(max(na.omit(precip[begin:endindex])) +"
"0","                  10 ^"
"0","                  (-r), r),"
"0","          length = (1 + ifelse(round(max("
"0","            na.omit(precip[begin:endindex])"
"0","          ) +"
"0","            10^(-r), r) < 10*10^(-r), floor(max(na.omit(precip[begin:endindex]))*10^r + 1), "
"0","                                                                                                                                                                                         4))))"
"0","      if (P.units=="""") {"
"0","        mtext(paste(""Precipitation"", P.units), 4, line = 2, cex = 0.9, adj = 1)"
"0","      } else  mtext(paste(""Precipitation ("", P.units, "")"", sep=""""), 4, line = 2, cex = 0.9, adj = 1)"
"0","      par(new = T)"
"0","    }"
"0","    if (!is.null(precip2)){"
"0","      barplot(precip2[begin:endindex], yaxt = ""n"", space = NULL, col=""pink"","
"0","              ylim = rev(c(0, 4 * max(na.omit(precip[begin:endindex])))), "
"0","              xaxt = ""n"")"
"0","      par(new = T)"
"0","    }"
"0","    "
"0","mycolors <- colorRampPalette(brewer.pal(8, ""Dark2""))(11)"
"0","labs <- c(""Bunny"", ""Cardinal"", ""Gravy"", ""Hen"", ""Lettuce"", ""Mouth"", ""Plume"", ""Turkey"", ""Walnut"",""Yam"")"
"0","    "
"0","    "
"0","# PLOT STREAMFLOW    "
"0","    plot(streamflow[begin:endindex], col = mycolors[1], type = ""l"", "
"0","         lwd = 2, ylab = stream.label, xaxt = ""n"", xlab = ""date"", "
"0","         ylim = c(0, 1.2 * max(na.omit(streamflow[begin:endindex]), na.omit(streamflow2[begin:endindex]))), "
"0","         axes = FALSE)"
"0","    "
"0",""
"0","    #mtext (expression(paste(""                              "", "" ("" , m^3/s, "")"", sep="""")), 2,3)"
"0","    if (S.units==""m3/s"" | S.units==""m3s""){"
"0","      mtext (expression(paste("" ("" , m^3/s, "")"", sep="""")), 2,1.5)"
"0","    } else if (S.units==""ft3/s"" | S.units==""ft3s"") {"
"0","      mtext (expression(paste("" ("" , ft^3/s, "")"", sep="""")), 2,1.5)"
"0","    } else if (S.units!="""") mtext (paste("" ("" , S.units, "")"", sep=""""), 2,1.5)"
"0","    lines(streamflow2[begin:endindex], col = mycolors[2], lwd = 2, "
"0","          lty = 1, xaxt = ""n"")"
"0","    if (!is.null(streamflow3)){"
"0","      lines(streamflow3[begin:endindex], col = mycolors[3], lwd = 2,   ##potential for more streamflows"
"0","            lty = 1, xaxt = ""n"")"
"0","    }"
"0","    if (!is.null(streamflow4)){"
"0","      lines(streamflow4[begin:endindex], col = mycolors[4], lwd = 2,   ##potential for more streamflows"
"0","            lty=1, xaxt = ""n"")"
"0","    }"
"0","    "
"0","# BRADY ADDED EXTRA FLOWS"
"0","    if (!is.null(streamflow5)){"
"0","      lines(streamflow5[begin:endindex], col = mycolors[5], lwd = 2,   ##potential for more streamflows"
"0","            lty=1, xaxt = ""n"")"
"0","    }"
"0","    if (!is.null(streamflow6)){"
"0","      lines(streamflow6[begin:endindex], col = mycolors[6], lwd = 2,   ##potential for more streamflows"
"0","            lty=1, xaxt = ""n"")"
"0","    }"
"0","    if (!is.null(streamflow7)){"
"0","      lines(streamflow7[begin:endindex], col = mycolors[7], lwd = 2,   ##potential for more streamflows"
"0","            lty=1, xaxt = ""n"")"
"0","    }"
"0","    if (!is.null(streamflow8)){"
"0","      lines(streamflow8[begin:endindex], col = mycolors[8], lwd = 2,   ##potential for more streamflows"
"0","            lty=1, xaxt = ""n"")"
"0","    }"
"0","    if (!is.null(streamflow9)){"
"0","      lines(streamflow9[begin:endindex], col = mycolors[9], lwd = 2,   ##potential for more streamflows"
"0","            lty=1, xaxt = ""n"")"
"0","    }"
"0","    if (!is.null(streamflow10)){"
"0","      lines(streamflow10[begin:endindex], col = mycolors[10], lwd = 2,   ##potential for more streamflows"
"0","            lty=1, xaxt = ""n"")"
"0","    }"
"0","    axis(side = 1, at = seq(1, (endindex - begin + 1), length = 14), "
"0","         pos = 0, labels = format(timeSeries[seq(begin, endindex, "
"0","                                                 length = 14)], ""%d-%b-%y""))"
"0","    legend(""bottomright"", inset = c(0.05, 0.475),legend=c(labs), col=c(mycolors), lty=1, cex=0.5)"
"0",""
"0","    "
"0","    axis(side = 2, pos = 0)"
"0","  }"
"0",""
"0","Fig3b <- hydrograph2("
"0","  input = depths,"
"0","  streamflow = depths$Bunny,"
"0","  precip = depths$Precipitation.cm,"
"0","  streamflow2 = depths$Cardinal,"
"0","  streamflow3 = depths$Gravy,"
"0","  streamflow4 = depths$Hen,"
"0","  streamflow5 = depths$Lettuce,"
"0","  streamflow6 = depths$Mouth,"
"0","  streamflow7 = depths$Plume,"
"0","  streamflow8 = depths$Turkey,"
"0","  streamflow9 = depths$Walnut,"
"0","  streamflow10 = depths$Yam,"
"0","  P.units = ""cm"""
"0",")"
